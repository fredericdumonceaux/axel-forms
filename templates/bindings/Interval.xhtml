<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:xt="http://ns.inria.org/xtiger" xml:lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

  <title>The 'interval' binding</title>
  
  <xt:head version="1.1" templateVersion="1.0" label="TestCase">
  </xt:head>

  <link rel="stylesheet" type="text/css"
        href="../../../axel/3rd-part/jquery/css/ui-lightness/jquery-ui-1.8.18.custom.css" />
  <link href="../../../axel/axel/axel.css" rel="stylesheet" type="text/css"></link>

  <script src="../../../axel/3rd-part/jquery/js/jquery-1.7.1.min.js" type="text/javascript"></script>
  <script src="../../../axel/3rd-part/jquery/js/jquery-ui-1.8.18.custom.min.js" type="text/javascript"></script>
  <script src="../../../axel/axel/axel.js"></script>

  <!-- AXEL-FORMS -->
  <script src="../../src/core/binding.js"></script>
  <script src="../../src/bindings/interval.js"></script>

  <script type="text/javascript">
    // TODO : use axel-micro data-command="transform" (?)
    var form;
    function init() {
      form = new xtiger.util.Form('../../../axel/axel/bundles');
      form.setTemplateSource(document);
      form.enableTabGroupNavigation();
      if (! form.transform()) { 
        alert(this .form.msg); 
      } else {
        $axel.binding.install();
      }
    }
    xtdom.addEventListener(window,  'load', init, false);
  </script>
  
  <style type="text/css">
    p.explic {
      font-size: 90%;
    }
    .avertissement {
      color: green;
    }
  </style>
  
  <!-- template enrichment : extracts and generates xt:attribute and xt:use sample code -->
  <link rel="stylesheet" type="text/css" href="../../../axel/templates/shared/demo.css" />
  <script type="text/javascript" charset="utf-8" src="../../../axel/templates/shared/demo.js"></script>
</head>
<body>
  
  <h1>The 'interval' binding</h1>
  
  <p><b>Goal</b> : turn two independent "date" fields into an interval selection so that you can only select a valid interval.</p>

  <p><b>Declaration</b> :</p>
  
  <ul>
    <li>Common ancestor's host : <code>data-binding="interval"</code>, <code>data-variable="<i>name</i>"</code></li>
    <li>Target hosts : <code>data-min-date="<i>name</i>"</code> and <code>data-max-date="<i>name</i>"</code></li>
  </ul>
  
  <h2>Single usage</h2>
  
  <p>The common ancestor's host is outside of any <code>xt:repeat</code>.</p>

  <div class="demo extract" data-binding="interval" data-variable="event">
    <span data-min-date="event">
      The interval starts from <xt:use types="text" param="filter=date;" label="Start"/>
    </span> and
    <span data-max-date="event">
      ends before <xt:use types="text" param="filter=date;" label="End"/>
    </span>
  </div>
  
  <h2>Usage in a <code>xt:repeat</code></h2>
  
  <p>The common ancestor's host MUST be within the same repeated slice to work. <i>Not fully implemented yet : we need to trigger binding installation within a slice after repetition.</i></p>

  <div class="demo extract">
    <xt:repeat minOccurs="1" maxOccurs="*" label="Intervals">
      <p data-binding="interval" data-variable="event">
        <xt:menu-marker/>
        <span data-min-date="event">
          The interval starts from <xt:use types="text" param="filter=date;" label="Start"/>
        </span> and
        <span data-max-date="event">
          ends before <xt:use types="text" param="filter=date;" label="End"/>
        </span>
      </p>
    </xt:repeat>
  </div>
</body> 
</html>
